scripted_gui = {
	surplus_appropriation_indicator = {
		context_type = player_context
		window_name = "surplus_appropriation_indicator"
		parent_window_token = top_bar
		dirty = sa_min_value
		visible = {
			NOT = {
				has_country_flag = no_sa_impact
			}
		}
	}
	surplus_appropriation_menu_entry = {
		context_type = player_context
		window_name = "surplus_appropriation_menu_entry"
		parent_window_name = "after_intel_agency_button"
		effects = {
            surplus_appropriation_menu_entry_button_click = {
				if = {
					limit = {
						check_variable = {
							sam_menu = 1
						}
					}
					set_variable = {
						sam_menu = 0
					}
				}
				else = {
					if = {
						limit = {
							is_ai = no
						}
						calc_surplus_appropriation_real_values = yes
					}
					set_variable = {
						sam_menu = 1
					}
				}
            }
		}
		triggers = {
			surplus_appropriation_menu_entry_button_visible = {
				set_temp_variable = {
					SAME_FRAME = 1
				}
				add_to_temp_variable = {
					SAME_FRAME = sam_menu
				}
			}
			surplus_appropriation_menu_entry_button_click_enabled = {
				custom_trigger_tooltip = {
					tooltip = sa_impact
					NOT = {
						has_country_flag = no_sa_impact
					}
				}
			}
		}
		properties = {
			surplus_appropriation_menu_entry_button = {
				frame = SAME_FRAME
			}
		}
	}
	surplus_appropriation_menu = {
		context_type = player_context
		window_name = "surplus_appropriation_menu"
		parent_window_token = top_bar
		visible = {
			check_variable = {
				sam_menu = 1
			}
			NOT = {
				has_country_flag = no_sa_impact
			}
		}
		dynamic_lists = {
			management_grid = {
				array = global.surplus_appropriation_grid
				change_scope = no
				entry_container = "management_container_entry"
				index = sa_i
			}
			slider_buttons_grid = {
				array = global.surplus_appropriation_slider_buttons
				change_scope = no
				entry_container = "slider_button_entry"
				index = sa_s_i
			}
		}
		triggers = {
			decrease_click_enabled = {
				check_variable = {
					surplus_appropriation_weights^sa_i > 0
				}
			}
			increase_click_enabled = {
				check_variable = {
					surplus_appropriation_weights^sa_i < 2
				}
			}
		}
		effects = {
			close_button_click = {
				set_variable = {
					sam_menu = 0
				}
			}
			decrease_click = {
				subtract_from_variable = {
					surplus_appropriation_weights^sa_i = 0.2
				}
				calc_surplus_appropriation_real_values = yes
			}
			increase_click = {
				add_to_variable = {
					surplus_appropriation_weights^sa_i = 0.2
				}
				calc_surplus_appropriation_real_values = yes
			}
			slider_button_click = {
				set_variable = {
					surplus_appropriation_weights^sa_i = global.surplus_appropriation_slider_buttons^sa_s_i
				}
				calc_surplus_appropriation_real_values = yes
			}
			min_slider_click = {
				set_variable = {
					surplus_appropriation_weights^sa_i = 0
				}
				calc_surplus_appropriation_real_values = yes
			}
			max_slider_click = {
				set_variable = {
					surplus_appropriation_weights^sa_i = 2
				}
				calc_surplus_appropriation_real_values = yes
			}
		}
		properties = {
			slider = {
				x = surplus_appropriation_slider_x_pos^sa_i
			}
			progerss = {
				frame = surplus_appropriation_progressbar_frame^sa_i
			}
			civil_food_modifier_icon = {

			}
			facilities_food_modifier_icon = {

			}
			army_food_modifier_icon = {
				
			}
		}
		#to do ai later, when this shit can be fixed! blyat'!
		#ai_enabled = {
		#	always = yes
		#}
		#ai_test_interval = 24
		#ai_test_variance = 0
		#ai_max_weight_taken_per_test = 3
		#ai_weights = {
		#	increase_click = {
		#		ai_will_do = {
		#			base = 1000
		#		}
		#	}
		#}
	}
}