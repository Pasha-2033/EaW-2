calculate_max_population = {
	every_state = {
		if = {
			limit = {
				check_variable = {
					state_population_k > global.max_population
				}
			}
			set_variable = {
				global.max_population = state_population_k
			}
		}
	}
}
calculate_all_states_building_slots = {
	every_state = {
		calculate_state_building_slots = yes
	}
}
calculate_state_building_slots = {
	set_variable = {
		common_builded_slots = 0
	}
	add_to_variable = {
		common_builded_slots = building_level@arms_factory
	}
	add_to_variable = {
		common_builded_slots = building_level@industrial_complex
	}
	add_to_variable = {
		common_builded_slots = building_level@dockyard
	}
	add_to_variable = {
		common_builded_slots = building_level@synthetic_refinery
	}
	add_to_variable = {
		common_builded_slots = building_level@fuel_silo
	}
	add_to_variable = {
		common_builded_slots = building_level@rocket_site
	}
	add_to_variable = {
		common_builded_slots = building_level@nuclear_reactor
	}
	resize_temp_array = {
		temp_array = 26
	}
	for_each_loop = {
		array = temp_array
		if = {
			limit = {
				meta_trigger = {
					text = {
						free_building_slots = {
							building = arms_factory
							include_locked = no
							size = [INDEX]
						}
					}
					INDEX = i
				}
			}
			set_variable = {
				common_empty_slots = i
			}
			set_temp_variable = {
				break = 1
			}
		}
	}
}