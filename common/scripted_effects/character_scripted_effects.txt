#use in unit leader (officer) scope!
generate_militarist_advisor = {
	if = {
		limit = {
			owner = {
				NOT = {
					has_country_flag = no_generic_militarist_political_advisor
					has_custom_advisors = yes
					has_allowed_idea_with_traits = {
						idea = armourer
						characters = yes
					}
				}
			}
		}
		add_advisor_role = {
			advisor = {
				slot = political_advisor
				cost = 150
				idea_token = THIS
				traits = {
					armourer
				}
				available = {
					militarism > 0.15
				}
			}
		}
	}
}
generate_portrait = {
	if = {
		limit = {
			has_variable = character_token
		}
		meta_effect = {
			text = {
				set_portraits = {
					character = [C]
					army = {
						small = [P]
					}
				}
			}
			C = "[?character_token.GetTokenKey]"
			P = "[character_portrait_gfx_object]"
		}
		clear_variable = character_token
	}
	else = {
		log = "Error - can`t get character without token"
	}
}
generate_race_trait = {
	if = {
		limit = {
			owner = {
				has_idea = multi_race
			}
		}
		add_trait = {
			trait = generic_race_trait
		}
	}
	else = {
		for_each_loop = {
			array = global.race_idea_tokens
			value = v
			meta_effect = {
				text = {
					if = {
						limit = {
							owner = {
								has_idea = [I]
							}
						}
						add_trait = {
							trait = [I]_trait
						}
						set_temp_variable = {
							break = 1
						}
					}
				}
				I = "[?v.GetTokenKey]"
			}
		}
	}
}